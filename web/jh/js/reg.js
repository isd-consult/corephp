$(function(){$(".capcha img").click(function(){$(this).attr("src","code?_="+(new Date()).getTime())});$("input[name=username]").change(function(){var b=$(this).val();if(b!=""){if(b.length<4){dialog.error("消息","帐户名由4-10个字符组成！");return}$.get("check",{username:$(this).val()},function(c){if(!c){$("#nameTips").html("＊该账号可用").css("color","blue")}else{$("#nameTips").html("＊该账号已被注册，不可用").css("color","red")}})}});$("#btnRegister").click(function(){a()});function a(){var g=$(".clearfix input[name=username]").val()==undefined?"":$(".clearfix input[name=username]").val().trim();if(g==""){dialog.error("消息","请输入账号名称！");return}var e=$("#aff-key").val();if(e==""){dialog.error("消息","请输入邀请码！");return}var b=$(".clearfix input[name=mobile]").val();var d=new RegExp("^[0-9]*$");if(b!==undefined&&(b==""||!d.test(b))){dialog.error("消息","请输入正确的11位数字手机号码！");return}var i=$(".clearfix input[name=wechat]").val();var h=new RegExp("^[a-zA-Z0-9-_]+$");if(i!==undefined&&i.trim()==""){dialog.error("消息","请输入微信号！");return}else{if(i!==undefined&&(!h.test(i)||i.length<4)){dialog.error("消息","请输入正确的微信号！");return}}var j=$(".clearfix input[name=password]").val();var k=$(".clearfix input[name=password1]").val();if(j==""){dialog.error("消息","请输入密码！");return}if(j!=k){dialog.error("消息","输入的密码不一致，请重新输入！");return}var c=$("#code").val();if(c==""){dialog.error("消息","请输入验证码！");return}var f=getQueryString("aff");if(f==""||f==null){f=LIBS.cookie("affid")}$("#btnRegister").attr("disabled","disabled");$("#btnRegister").val("提交中，请等待...");$.post("reg",{username:g,password:j,parent:f,weChatId:i,mobile:b,affKey:e,code:c},function(m){if(m.success){$("#aff-key-login").val(e);var l={"马上登录":function(){doLogin(g,j)}};dialog.alert1("消息","恭喜，注册成功！",l,"/index")}else{dialog.error("消息",m.message);$(".capcha img").click()}$("#btnRegister").removeAttr("disabled");$("#btnRegister").val("创建帐号")})}});